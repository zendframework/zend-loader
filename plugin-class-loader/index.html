<!DOCTYPE html>
<html lang="en">


<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Autoloading and plugin loading strategies">  
    <link rel="canonical" href="https://docs.zendframework.com/plugin-class-loader/">
    <link rel="shortcut icon" href="../img/favicon.ico">

    <title>PluginClassLoader - zend-loader - Zend Framework Docs</title>

    <link rel="stylesheet" href="/css/styles.css">
</head>
<body id="page-top">

    
    <div class="navbar navbar-default" role="navigation">
    <div class="container">
        <div class="navbar-header">

            
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            
            <span class="navbar-brand">
                <a class="logo-link" href="https://framework.zend.com/" data-tooltip data-placement="bottom" title="Go to the ZF homepage">
                    <img src="../img/zend-framework-logo.svg" height="28" alt="Zend Framework">
                </a>
            </span>
        </div>

        <div class="navbar-collapse collapse">

            
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="https://framework.zend.com/about">About</a>
                </li>
                <li>
                    <a href="https://framework.zend.com/downloads">Install</a>
                </li>
                <li class="active">
                    <a href="https://docs.zendframework.com">Documentation</a>
                </li>
                <li>
                    <a href="https://www.zend.com/en/services/training">Training</a>
                </li>
                <li>
                    <a href="https://framework.zend.com/blog">Blog</a>
                </li>
                <li>
                    <a href="https://framework.zend.com/participate">Participate</a>
                </li>
            </ul>

            
            
                <div class="nav navbar-nav navbar-collapse visible-xs-block ">
                    
    <div class="subnavigation hidden-print">
        <h4 class="subnavigation__title">
            <a href="..">zend-loader</a>
        </h4>

        <h5 class="subnavigation__subtitle">Table of Contents</h5>

        <ul class="subnavigation__list">
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item">
                                <span class="subnavigation__headline">Reference</span>
                                <ul class="subnavigation__list">
                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../autoloader-factory/" class="subnavigation__link">AutoloaderFactory</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../standard-autoloader/" class="subnavigation__link">StandardAutoloader</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../class-map-autoloader/" class="subnavigation__link">ClassMapAutoloader</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../module-autoloader/" class="subnavigation__link">ModuleAutoloader</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../spl-autoloader/" class="subnavigation__link">SplAutoloader</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item subnavigation__list-item--active">
        <a href="./" class="subnavigation__link">PluginClassLoader</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../short-name-locator/" class="subnavigation__link">ShortNameLocator</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../plugin-class-locator/" class="subnavigation__link">PluginClassLocator</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../classmap-generator/" class="subnavigation__link">ClassMap Generator</a>
    </li>

                                    
                                </ul>
                            </li>
                        
                    
                
            
        </ul>
    </div>

                </div>
            

            
            <div class="nav navbar-nav navbar-collapse visible-xs-block">
                <div class="component-selector">
    <h4 class="component-selector__title">Components</h4>
    <h5 class="component-selector__subtitle">Find documentation…</h5>
    <select class="form-control component-selector__control">
        <option value="/">Overview</option>
        <optgroup label="Components"></optgroup>
    </select>
</div>
            </div>
        </div>
    </div>
</div>

    
    <header class="header">
    <div class="container">
        <div class="row">

            
            <div class="col-xs-8">
                <h1 class="header__title">
                    Documentation

                    
                        <small class="header__subtitle">zend-loader</small>
                    
                </h1>
            </div>

            
            <div class="col-xs-4 text-right">
                
                    

                    <a href="#" class="header__link header__link--search" data-toggle="modal" data-target="#mkdocs_search_modal" title="Open search">
                        <i class="fa fa-search"></i> Search
                    </a>
                    <a href="https://github.com/zendframework/zend-loader/" class="header__link header__link--github" title="Go to repository of zend-loader">
                        <i class="fa fa-github"></i> GitHub
                    </a>
                
            </div>
        </div>
    </div>
</header>

    
    <div class="laminas-announcement">
    <div class="container">
        <div class="row">
            <div class="col-xs-12"><strong>
                This package has moved. Visit its replacement, <a href="https://docs.laminas.dev/laminas-loader/">laminas/laminas-loader.</a>
            </strong></div>
        </div>
    </div>
</div>

    
    <div class="container">
        <div class="row">
            <div class="col-md-9 col-xs-12 content" role="main">
            <!-- content:begin -->
                
                    <ol class="breadcrumb" role="navigation" aria-label="breadcrumbs navigation">
    <li><a href="https://framework.zend.com/">Home</a></li>

    
        <li><a href="https://docs.zendframework.com/">Documentation</a></li>

        
            <li><a href="..">zend-loader</a></li>

            
                
                    
                    
                        <li>Reference</li>
                    
                
            

            <li class="active">PluginClassLoader</li>
        
    
</ol>






    
    
        <h2 class="chapter__headline">Reference</h2>
    

    <div>
        
    

    
    
        <div class="toc">
            <h6 class="toc__headline">In This Article</h6>
            <ul class="toc__list">
                
                    <li class="toc__entry">
                        <a href="#quick-start" class="toc__link">Quick Start</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#configuration-options" class="toc__link">Configuration Options</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#available-methods" class="toc__link">Available Methods</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#examples" class="toc__link">Examples</a>
                    </li>
                
            </ul>
        </div>
    

    </div>

    <h1 id="the-pluginclassloader">The PluginClassLoader</h1>
<p>Resolving plugin names to class names is a common requirement within
applications.  The <code>PluginClassLoader</code> implements the interfaces
<a href="../plugin-class-locator/">PluginClassLocator</a>,
<a href="../short-name-locator/">ShortNameLocator</a>, and <code>IteratorAggregate</code>, providing a
mechanism for aliasing plugin names to classnames for later retrieval.</p>
<p>While it can act as a standalone class, it is intended that developers will
extend the class to provide a per-component plugin map. This allows seeding the
map with the most often-used plugins, while simultaneously allowing the end-user
to overwrite existing or register new plugins.</p>
<p>Additionally, <code>PluginClassLoader</code> provides the ability to statically seed all
new instances of a given <code>PluginClassLoader</code> or one of its extensions (via Late
Static Binding). If your application will always call for defining or overriding
particular plugin maps on given <code>PluginClassLoader</code> extensions, this is a
powerful capability.</p>
<h2 id="quick-start">Quick Start</h2>
<p>Typical use cases involve instantiating a <code>PluginClassLoader</code>, seeding it
with one or more plugin/class name associations, and then using it to retrieve
the class name associated with a given plugin name.</p>
<pre><code class="language-php">use Zend\Http\HeaderLoader;

// Provide a global map, or override defaults:
HeaderLoader::addStaticMap([
    'xrequestedfor' =&gt; 'My\Http\Header\XRequestedFor',
]);

// Instantiate the loader:
$loader = new Zend\Http\HeaderLoader();

// Register a new plugin:
$loader-&gt;registerPlugin('xForwardedFor', 'My\Http\Header\XForwardedFor');

// Load/retrieve the associated plugin class:
$class = $loader-&gt;load('xrequestedfor'); // 'My\Http\Header\XRequestedFor'
</code></pre>

<blockquote>
<h3>Case Sensitivity</h3>
<p>The <code>PluginClassLoader</code> is designed to do case-insensitive plugin name
lookups. While the above example defines an "xForwardedFor" plugin name,
internally, this will be stored as "xforwardedfor". If another plugin is
registered with the same word but using a different casing structure, it will
overwrite this entry.</p>
</blockquote>
<h2 id="configuration-options">Configuration Options</h2>
<p>The constructor may take a single option, an array or <code>Traversable</code> object of key/value pairs
corresponding to a plugin name and class name, respectively.</p>
<h2 id="available-methods">Available Methods</h2>
<h3>__construct</h3>
<pre><code class="language-php">__construct(string|array|Traversable $map = null) : void
</code></pre>

<p>The constructor is used to instantiate and initialize the plugin class loader.
If passed a string, an array, or a <code>Traversable</code> object, it will pass this to
the <a href="#registerplugins">registerPlugins()</a> method in order to seed (or overwrite)
the plugin class map.</p>
<h3>addStaticMap</h3>
<pre><code class="language-php">static addStaticMap(array|Traversable $map) : void
</code></pre>

<p>Static method for globally pre-seeding the loader with a class map. It accepts
either an array or <code>Traversable</code> object of plugin name/class name pairs.</p>
<p>When using this method, be certain you understand the precedence in which maps
will be merged; in decreasing order of preference:</p>
<ul>
<li>Manually registered plugin/class name pairs (e.g., via
  <a href="#registerplugin">registerPlugin()</a> or
  <a href="#registerplugins">registerPlugins()</a>.</li>
<li>A map passed to the constructor.</li>
<li>The static map.</li>
<li>The map defined within the class itself.</li>
</ul>
<p>Also, please note that calling the method will <strong>not</strong> affect any instances
already created.</p>
<h3>registerPlugin</h3>
<pre><code class="language-php">registerPlugin(string $shortName, string $className) : void
</code></pre>

<p>Defined by the <a href="../plugin-class-locator/">PluginClassLocator</a> interface. Expects
two string arguments, the plugin <code>$shortName</code>, and the class <code>$className</code> which
it represents.</p>
<h3>registerPlugins</h3>
<pre><code class="language-php">registerPlugins(string|array|Traversable $map) : void
</code></pre>

<p>If a string argument is provided, <code>registerPlugins()</code> assumes this is a class
name. If the class does not exist, an exception will be thrown. If it does, it
then instantiates the class and checks to see whether or not it implements
<code>Traversable</code>, iterating it if it does.</p>
<p>Each key/value pair obtained during iteration is then passed to
<a href="#registerPlugin">registerPlugin()</a> using the key as the plugin name and the
value as the class name.</p>
<h3>unregisterPlugin</h3>
<pre><code class="language-php">unregisterPlugin(string $shortName) : void
</code></pre>

<p>Defined by the <code>PluginClassLocator</code> interface; remove a plugin/class association
from the plugin class map.</p>
<h3>getRegisteredPlugins</h3>
<pre><code class="language-php">getRegisteredPlugins() : array
</code></pre>

<p>Defined by the <code>PluginClassLocator</code> interface; return the entire plugin class
map as an array.</p>
<h3>isLoaded</h3>
<pre><code class="language-php">isLoaded(string $name) : bool
</code></pre>

<p>Defined by the <code>ShortNameLocator</code> interface; determine if the given plugin has
been resolved to a class name.</p>
<h3>getClassName</h3>
<pre><code class="language-php">getClassName(string $name) : string
</code></pre>

<p>Defined by the <code>ShortNameLocator</code> interface; return the class name to which a
plugin name resolves.</p>
<h3>load</h3>
<pre><code class="language-php">load(string $name) : string|false
</code></pre>

<p>Defined by the <code>ShortNameLocator</code> interface; attempt to resolve a plugin name to
a class name. If successful, returns the class name; otherwise, returns a
boolean <code>false</code>.</p>
<h3>getIterator</h3>
<pre><code class="language-php">getIterator() : Traversable
</code></pre>

<p>Defined by the <code>IteratorAggregate</code> interface; allows iteration over the plugin
class map. This can come in useful for using <code>PluginClassLoader</code> instances to
other <code>PluginClassLoader</code> instances in order to merge maps.</p>
<h2 id="examples">Examples</h2>
<h3>Using Static Maps</h3>
<p>It's often convenient to provide global overrides or additions to the maps in a
<code>PluginClassLoader</code> instance. This can be done using the <code>addStaticMap()</code>
method:</p>
<pre><code class="language-php">use Zend\Loader\PluginClassLoader;

PluginClassLoader::addStaticMap([
    'xrequestedfor' =&gt; 'My\Http\Header\XRequestedFor',
]);
</code></pre>

<p>Any later instances created will now have this map defined, allowing you to load
that plugin.</p>
<pre><code class="language-php">use Zend\Loader\PluginClassLoader;

$loader = new PluginClassLoader();
$class = $loader-&gt;load('xrequestedfor'); // My\Http\Header\XRequestedFor
</code></pre>

<h3>Creating a pre-loaded map</h3>
<p>In many cases, you know exactly which plugins you may be drawing upon on a
regular basis, and which classes they will refer to. In this case, extend
the <code>PluginClassLoader</code> and define the map within the extending class.</p>
<pre><code class="language-php">namespace My\Plugins;

use Zend\Loader\PluginClassLoader;

class PluginLoader extends PluginClassLoader
{
    /**
     * @var array Plugin map
     */
    protected $plugins = [
        'foo'    =&gt; 'My\Plugins\Foo',
        'bar'    =&gt; 'My\Plugins\Bar',
        'foobar' =&gt; 'My\Plugins\FooBar',
    ];
}
</code></pre>

<p>At this point, you can instantiate the map and immediately use it.</p>
<pre><code class="language-php">$loader = new My\Plugins\PluginLoader();
$class  = $loader-&gt;load('foobar'); // My\Plugins\FooBar
</code></pre>

<p><code>PluginClassLoader</code> makes use of late static binding, allowing per-class static
maps. If you want to allow defining a <a href="#using-static-maps">static map</a> specific
to this extending class, declare a protected static <code>$staticMap</code> property:</p>
<pre><code class="language-php">namespace My\Plugins;

use Zend\Loader\PluginClassLoader;

class PluginLoader extends PluginClassLoader
{
    protected static $staticMap = [];

    // ...
}
</code></pre>

<p>To inject the static map, call the <code>addStaticMap()</code> on the extension class:</p>
<pre><code class="language-php">PluginLoader::addStaticMap([
    'baz' =&gt; 'My\Plugins\Baz',
]);
</code></pre>

<h3>Extending a plugin map using another plugin map</h3>
<p>In some cases, a general map class may already exist; as an example, several
Zend Framework components defining plugin brokers have an associated
<code>PluginClassLoader</code> extension defining the plugins available for that component
within the framework. What if you want to define some additions to these? Where
should that code go?</p>
<p>One possibility is to define the map in a configuration file, and then inject
the configuration into an instance of the plugin loader.</p>
<p>Another solution is to define a new plugin map class. The class name or an
instance of the class may then be passed to the constructor or
<code>registerPlugins()</code>.</p>
<pre><code class="language-php">namespace My\Plugins;

use Zend\Loader\PluginClassLoader;
use Zend\Http\HeaderLoader;

class PluginLoader extends PluginClassLoader
{
    /**
     * @var array Plugin map
     */
    protected $plugins = [
        'foo'    =&gt; 'My\Plugins\Foo',
        'bar'    =&gt; 'My\Plugins\Bar',
        'foobar' =&gt; 'My\Plugins\FooBar',
    ];
}

// Inject in constructor:
$loader = new HeaderLoader(PluginLoader::class); // as string class name
$loader = new HeaderLoader(new PluginLoader());  // as instance

// Or via registerPlugins():
$loader-&gt;registerPlugins(PluginLoader::class); // as string class name
$loader-&gt;registerPlugins(new PluginLoader());  // as instance
</code></pre>




    <nav>
    <ul class="page-nav hidden-print">

        
        <li class="page-nav__item">
            
                <a rel="prev" class="page-nav__link page-nav__link--prev" href="../spl-autoloader/">
                    <i class="fa fa-chevron-left"></i> Previous
                </a>
            
        </li>

        
        <li class="page-nav__item">
            
                <a rel="next" class="page-nav__link page-nav__link--next" href="../short-name-locator/">
                    Next <i class="fa fa-chevron-right"></i>
                </a>
            
        </li>
    </ul>
</nav>




    <div class="help-wanted">
        <p>
            Found a mistake or want to contribute to the documentation?
            <a href="https://github.com/zendframework/zend-loader/edit/master/docs/book/plugin-class-loader.md" target="_blank" class="help-wanted__link">
                Edit this page on GitHub!
            </a>
        </p>
    </div>

                
            <!-- content:end -->
            </div>
            <div class="col-md-3 col-xs-12 sidebar">
                
                    <div class="component-selector">
    <h4 class="component-selector__title">Components</h4>
    <h5 class="component-selector__subtitle">Find documentation…</h5>
    <select class="form-control component-selector__control">
        <option value="/">Overview</option>
        <optgroup label="Components"></optgroup>
    </select>
</div>
                    
    <div class="subnavigation hidden-print">
        <h4 class="subnavigation__title">
            <a href="..">zend-loader</a>
        </h4>

        <h5 class="subnavigation__subtitle">Table of Contents</h5>

        <ul class="subnavigation__list">
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item">
                                <span class="subnavigation__headline">Reference</span>
                                <ul class="subnavigation__list">
                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../autoloader-factory/" class="subnavigation__link">AutoloaderFactory</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../standard-autoloader/" class="subnavigation__link">StandardAutoloader</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../class-map-autoloader/" class="subnavigation__link">ClassMapAutoloader</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../module-autoloader/" class="subnavigation__link">ModuleAutoloader</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../spl-autoloader/" class="subnavigation__link">SplAutoloader</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item subnavigation__list-item--active">
        <a href="./" class="subnavigation__link">PluginClassLoader</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../short-name-locator/" class="subnavigation__link">ShortNameLocator</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../plugin-class-locator/" class="subnavigation__link">PluginClassLocator</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../classmap-generator/" class="subnavigation__link">ClassMap Generator</a>
    </li>

                                    
                                </ul>
                            </li>
                        
                    
                
            
        </ul>
    </div>

                
            </div>
        </div>
    </div>

    
    <footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-9">
                <h5>Zend Framework</h5>
                <ul>
                    <li><a href="https://framework.zend.com/">framework.zend.com</a></li>
                    <li><a href="https://docs.zendframework.com">docs.zendframework.com</a></li>
                    <li><a href="https://packages.zendframework.com">packages.zendframework.com</a></li>
                    <li><a href="https://apigility.org">apigility.org</a></li>
                    <li><a href="https://getexpressive.org/">getexpressive.org</a></li>
                </ul>
            </div>
        </div>

        
        <div class="row">
            <div class="col-md-12 text-center">
                <a class="footer__button" href="#page-top"><i class="fa fa-chevron-up" aria-hidden="true"></i></a>
            </div>
        </div>

        <div class="row">

            
            <div class="col-md-9">
                <h4 class="footer__headline">Copyright</h4>
                <p>&copy; 2006-2020 by <a href="https://www.zend.com/">Zend</a> by <a href="https://www.perforce.com/">Perforce</a>.</p>
            </div>

            
            <div class="col-md-3">
                <h4 class="footer__headline">Support</h4>
                <ul class="support__list">
                    <li class="support__list-item">
                        <a href="https://discourse.laminas.dev" class="support__link" title="Forum"><i class="fa fa-comments"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://laminas.dev/chat/" class="support__link" title="Chat"><i class="fa fa-slack"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://github.com/zendframework" class="support__link" title="Github"><i class="fa fa-github"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://twitter.com/zfdevteam" class="support__link" title="Twitter"><i class="fa fa-twitter"></i></a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</footer>

<nav class="cookie-bar navbar navbar-fixed-bottom navbar-default hidden">
    <div class="container">
        <p class="navbar-text">
            We use cookies to allow you to dismiss dialogs such as the Laminas
            Project notification.
        </p>
        <button type="button" class="cookie-button btn btn-default navbar-btn">Allow Cookies</button>
    </div>
</nav>

    <script>
        var base_url = '..',
            siteName = 'zend-loader';
    </script>
    <script src="/js/scripts.js"></script>
    <script src="../search/main.js"></script>

    
    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                        <span class="sr-only">Close</span>
                    </button>
                    <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                </div>
                <div class="modal-body">
                    <p>
                        From here you can search these documents. Enter your search terms below.
                    </p>
                    <form role="form">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                        </div>
                    </form>
                    <div id="mkdocs-search-results"></div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>



</body>


</html>
